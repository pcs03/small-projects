import heapq as heap
import time


def heuristic(pos, goal):
    distance = abs(pos[0] - goal[0]) + abs(pos[1] - goal[1])
    return distance


grid = """\
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
83617035724012096174782912354747029610842953672486930185467293184572063094518706537913250846921572063409182376915724630954712639815470261849563027418063982157300486924130
56739021840582673918420567124053718679318465248712903569108370452831746935427068198471369270814567931803264709513846023719841537208450923786140579213867041853982706473512
75634018942897136507138624915840762329451860786350271493087451682360579421576903480124765398013527684961483259706517482390675841239806537182945076012435907862184397065218
59384702168412075390752834120173986485460312796715843034296571818973420657023849134576590812450369718547613089254671804365928741532679048125370649173084526137975402639157
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
17325489067948351205971628424589637003174562876812049380765194250693481792187035642953176420567314829041328507619825403796123465728950318274605974836251489032756341907826
46503287915690724831985647021398764567450139258063421934617820570241396815829436780416923574281750469328570142386920561473259874138562731024951370834697081542378690512473
"""
grid = grid.splitlines()


def dijkstra(start, goal):
    pq = [(0, start)]
    visited = set()

    while pq:
        current_cost, current_position = heap.heappop(pq)

        if current_position == goal:
            print(f"Found goal with cost {current_cost}")
            break

        for direction in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            new_position = (
                current_position[0] + direction[0],
                current_position[1] + direction[1],
            )

            if new_position in visited:
                continue

            if 0 <= new_position[0] < len(grid) and 0 <= new_position[1] < len(grid[0]):
                new_cost = current_cost + int(grid[new_position[0]][new_position[1]])
                heap.heappush(pq, (new_cost, new_position))

        visited.add(current_position)


class Node:
    def __init__(self, state, cost, parent, heuristic = 0):
        self.state = state
        self.cost = cost
        self.heuristic = heuristic
        self.parent = parent

    def __lt__(self, other):
        return self.cost + self.heuristic < other.cost + other.heuristic

    def __le__(self, other):
        return self.cost + self.heuristic <= other.cost + other.heuristic

    def __gt__(self, other):
        return self.cost + self.heuristic > other.cost + other.heuristic

    def __ge__(self, other):
        return self.cost + self.heuristic >= other.cost + other.heuristic

    def __eq__(self, other):
        return self.cost + self.heuristic == other.cost + other.heuristic

    def __ne__(self, other):
        return self.cost + self.heuristic != other.cost + other.heuristic


def dijkstra2(start, goal):
    startnode = Node(start, 0, None)
    pq = [startnode]
    visited = set()

    while pq:
        current = heap.heappop(pq)

        if current.state == goal:
            print(f"Found goal with cost {current.cost}")
            break

        for direction in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            new_position = (
                current.state[0] + direction[0],
                current.state[1] + direction[1],
            )

            if new_position in visited:
                continue

            if 0 <= new_position[0] < len(grid) and 0 <= new_position[1] < len(grid[0]):
                new_cost = current.cost + int(grid[new_position[0]][new_position[1]])
                heap.heappush(pq, Node(new_position, new_cost, current))
        visited.add(current.state)


def astar(start, goal):
    pq = [(0 + heuristic(start, goal), 0, start)]
    visited = set()

    while pq:
        heuristic_cost, current_cost, current_position = heap.heappop(pq)

        if current_position == goal:
            print(f"Found goal with cost {current_cost}")
            break

        for direction in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            new_position = (
                current_position[0] + direction[0],
                current_position[1] + direction[1],
            )

            if new_position in visited:
                continue

            if 0 <= new_position[0] < len(grid) and 0 <= new_position[1] < len(grid[0]):
                new_cost = current_cost + int(grid[new_position[0]][new_position[1]])
                heuristic_cost = heuristic(new_position, goal)
                heap.heappush(pq, (new_cost + heuristic_cost, new_cost, new_position))

        visited.add(current_position)


def astar2(start, goal):
    startnode = Node(start, 0, None, heuristic(start, goal))
    pq = [startnode]
    visited = set()

    while pq:
        current = heap.heappop(pq)

        if current.state == goal:
            print(f"Found goal with cost {current.cost}")
            break

        for direction in [(1, 0), (-1, 0), (0, 1), (0, -1)]:
            new_position = (
                current.state[0] + direction[0],
                current.state[1] + direction[1],
            )

            if new_position in visited:
                continue

            if 0 <= new_position[0] < len(grid) and 0 <= new_position[1] < len(grid[0]):
                new_cost = current.cost + int(grid[new_position[0]][new_position[1]])
                heuristic_cost = heuristic(new_position, goal)
                heap.heappush(pq, Node(new_position, new_cost, current, heuristic_cost))
        visited.add(current.state)


start = (0, 0)
goal = (len(grid) - 1, len(grid[0]) - 1)

starttime = time.time()
dijkstra(start, goal)
print(f"Dijkstra completed in {time.time() - starttime}")

starttime = time.time()
dijkstra2(start, goal)
print(f"Dijkstra with Node class completed in {time.time() - starttime}")

starttime = time.time()
astar(start, goal)
print(f"A* completed in {time.time() - starttime}")

starttime = time.time()
astar2(start, goal)
print(f"A* with Node class completed in {time.time() - starttime}")
